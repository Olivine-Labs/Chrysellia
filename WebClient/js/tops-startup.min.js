$(function(){FB.init({appId:"119442588120693",status:true,cookie:true,xfbml:true});$("#playNow").dialog({modal:true,title:"Log In / Register a New Account",width:600,autoOpen:false});$(".playNow").bind("click",function(a){a.preventDefault();if($.cookie("l")=="true")window.location="./account.php";else $("#playNow").dialog("open")});$("#registerForm").bind("submit",function(a){a.preventDefault();a=true;var b=$("#ca_username").val(),c=$("#ca_password").val(),d=$("#ca_email").val();if(b.length<4){a=
false;$("#ca_username_validator").html("<span class='ui-state-error ui-corner-all'><span class='ui-icon ui-icon-alert'></span>Username too short.</span>")}if(c.length<4){a=false;$("#ca_password_validator").html("<span class='ui-state-error ui-corner-all'><span class='ui-icon ui-icon-alert'></span>Password too short.</span>")}a&&RegisterAccount(b,c,d);return false});$("#loginForm").bind("submit",function(a){a.preventDefault();if($("ui-state-error:visible",$(".logIn")).length>0)return false;a=$("#li_username").val();
var b=$("#li_password").val();LogInAccount(a,b);return false});$("#quickLoginForm").bind("submit",function(a){a.preventDefault();if($("ui-state-error:visible",$("#topLoginForm")).length>0)return false;a=$("#quickLogin_un").val();var b=$("#quickLogin_pw").val();LogInAccount(a,b);return false});$("#fbregister").bind("click",function(a){a.preventDefault();var b="",c="",d="";FB.getLoginStatus(function(e){if(e.session){b=e.session.uid;c=e.session.access_token;FB.api("/me",function(f){d=f.email;RegisterAccount(b,
c,d)})}else FB.login(function(f){if(f.session){b=f.session.uid;c=f.session.access_token;f.perms&&FB.api("/me",function(g){d=g.email;RegisterAccount(b,c,d)})}},{perms:"read_stream,publish_stream,offline_access,email,create_event,user_birthday"})})});$("#fblogin").bind("click",function(a){a.preventDefault();var b="",c="";FB.getLoginStatus(function(d){if(d.session){b=d.session.uid;c=d.session.access_token;LogInAccount(b,c)}else FB.login(function(e){if(e.session){b=e.session.uid;c=e.session.access_token;
LogInAccount(b,c)}})})});$("#topsOptions button").button({icons:{primary:"ui-icon-search"}});$("#topsOptions").bind("submit",function(a){a.preventDefault();$("#topsOptions button").button("option","disabled",true);a=$("#sortOptions").val();var b=$("#sortDirection").val();vc.api.GetTops(25,0,b,a,"",ProcessTops)});vc.api.GetTops(25,0,0,0,"",ProcessTops)});
function ProcessTops(a){$("#topsOptions button").button("option","disabled",false);if(a.Result==vc.ER_SUCCESS){var b=$("#topList"),c=a.Data;b.children().length>0?$("#topList").animate({opacity:0},250,function(){b.empty().css({opacity:1});$("#topstmpl").tmpl({character:c}).appendTo(b)}):$("#topstmpl").tmpl({character:c}).appendTo(b)}}function LogInAccount(a,b){vc.as.Login(a,$.md5(b),function(c){ProcessLogin(c.Result)})}
function RegisterAccount(a,b,c){vc.as.Register(a,$.md5(b),c,function(d){switch(d.Result){case vc.ER_SUCCESS:vc.as.Login(a,$.md5(b),function(e){ProcessLogin(e.Result)});break;case vc.ER_BADDATA:case vc.ER_MALFORMED:case vc.ER_DBERROR:alert("Please check username and password requirements and try again.");break;case vc.ER_ALREADYEXISTS:alert("An account with that Facebook login already exists!");break;default:alert("An error has occured. Try again later.")}})}
function ProcessLogin(a){switch(a){case vc.ER_SUCCESS:$.cookie("l",true);window.location="./account.php";break;case vc.ER_BADDATA:case vc.ER_MALFORMED:case vc.ER_DBERROR:alert("Please check login information and try again.");break;case vc.ER_ACCESSDENIED:alert("An account with those credentials was not found.");break;default:alert("An error has occured. Try again later.")}}
AlignName=function(a,b){var c="Neutral";if(a<=-100)c="Evil ";else if(a>=100)c="Good";if(b<=-100){if(c!="Neutral")c+=" ";c+="Chaotic"}else if(b>=100){if(c!="Neutral")c+=" ";c+="Ordered"}return c};